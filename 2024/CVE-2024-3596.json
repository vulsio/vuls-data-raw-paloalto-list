{
	"id": "CVE-2024-3596",
	"title": "PAN-OS: CHAP and PAP When Used with RADIUS Authentication Lead to Privilege Escalation",
	"problem": [
		{
			"lang": "en",
			"value": "This vulnerability allows an attacker performing a meddler-in-the-middle attack between Palo Alto Networks PAN-OS firewall and a RADIUS server to bypass authentication and escalate privileges to ‘superuser’ when RADIUS authentication is in use and either CHAP or PAP is selected in the RADIUS server profile.\n\nCHAP and PAP are protocols with no Transport Layer Security (TLS), and hence vulnerable to meddler-in-the-middle attacks. Neither protocol should be used unless they are encapsulated by an encrypted tunnel. If they are in use, but are encapsulated within a TLS tunnel, they are not vulnerable to this attack.\n\nFor additional information regarding this vulnerability, please see https://blastradius.fail."
		}
	],
	"solution": [
		{
			"lang": "en",
			"value": "The best way to address this issue is by using encrypted and authenticated channels that offer modern cryptographic security guarantees.\n\nConfigure an alternate authentication mechanism if you are using RADIUS with a CHAP or PAP authentication protocol. PAN-OS provides the following alternate RADIUS authentication mechanisms: PEAP-MSCHAPv2 (default), PEAP with GTC, and EAP-TTLS with PAP. For more information, please see https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/authentication/configure-radius-authentication.\n\nIn addition, instead of using RADIUS, you can configure an alternate authentication mechanism using one of the options described here: https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/authentication.\n\nIf you are a Prisma Access customer using a RADIUS configuration with PAP or CHAP in your profile and have not applied one of the changes described above, please reach out to TAC/CS to schedule an upgrade window.\n\nPAN-OS 9.1.19, PAN-OS 10.1.14, PAN-OS 10.2.10, PAN-OS 11.0.7, PAN-OS 11.1.3, and all later PAN-OS versions add a new feature to enforce an authentication check in RADIUS. This new feature is disabled by default to match the existing behavior. To enable this feature, run the following commands:\n\n> set auth radius-require-msg-authentic yes\n\nTo confirm that the setting was correctly enabled, run the following command:\n\n> show auth radius-require-msg-authentic\n\nIf set correctly, the response will say \"yes\". This setting is persistent across reboots. No ‘commit’ is required for this to take effect.\n\nPlease note that this feature requires that the RADIUS server has been updated to support the new protocol changes, as detailed in https://kb.cert.org/vuls/id/456537. If your RADIUS authentication breaks when radius-require-msg-authentic is set to yes, please work with your RADIUS server vendor for support with the RADIUS server upgrade process."
		}
	],
	"severity": "MEDIUM",
	"base_severity": "",
	"base_score": 0,
	"threat_severity": "",
	"show_cvss_in_header": true,
	"AV": "NETWORK",
	"AC": "HIGH",
	"PR": "NONE",
	"UI": "PASSIVE",
	"C": "product:NONE subsequent:HIGH",
	"I": "product:NONE subsequent:HIGH",
	"A": "product:NONE subsequent:NONE",
	"product": [
		"PAN-OS",
		"Cloud NGFW",
		"Prisma Access"
	],
	"version": [
		"PAN-OS 11.2",
		"PAN-OS 11.1",
		"PAN-OS 10.2",
		"PAN-OS 10.1",
		"PAN-OS 11.0",
		"PAN-OS 9.1",
		"Cloud NGFW",
		"Prisma Access"
	],
	"affected": [
		"None",
		"< 11.1.3",
		"< 10.2.10",
		"< 10.1.14",
		"< 11.0.4-h5, < 11.0.6",
		"< 9.1.19",
		"None",
		"All"
	],
	"affected_list": [
		"Prisma Access",
		"PAN-OS 11.2",
		"PAN-OS 11.1.2-h4",
		"PAN-OS 11.1.2-h3",
		"PAN-OS 11.1.2-h2",
		"PAN-OS 11.1.2-h1",
		"PAN-OS 11.1.2",
		"PAN-OS 11.1.0",
		"PAN-OS 11.1",
		"PAN-OS 11.0.4",
		"PAN-OS 11.0.3-h12",
		"PAN-OS 11.0.3-h11",
		"PAN-OS 11.0.3-h10",
		"PAN-OS 11.0.3-h9",
		"PAN-OS 11.0.3-h8",
		"PAN-OS 11.0.3-h7",
		"PAN-OS 11.0.3-h6",
		"PAN-OS 11.0.3-h5",
		"PAN-OS 11.0.3-h4",
		"PAN-OS 11.0.3-h3",
		"PAN-OS 11.0.3-h2",
		"PAN-OS 11.0.3-h1",
		"PAN-OS 11.0.3",
		"PAN-OS 11.0.2-h2",
		"PAN-OS 11.0.2-h1",
		"PAN-OS 11.0.2",
		"PAN-OS 11.0.1-h2",
		"PAN-OS 11.0.1-h1",
		"PAN-OS 11.0.1",
		"PAN-OS 11.0.0-h1",
		"PAN-OS 11.0.0",
		"PAN-OS 11.0",
		"PAN-OS 10.2.9",
		"PAN-OS 10.2.8-h4",
		"PAN-OS 10.2.8-h3",
		"PAN-OS 10.2.8-h2",
		"PAN-OS 10.2.8-h1",
		"PAN-OS 10.2.8",
		"PAN-OS 10.2.7-h6",
		"PAN-OS 10.2.7-h5",
		"PAN-OS 10.2.7-h4",
		"PAN-OS 10.2.7-h3",
		"PAN-OS 10.2.7-h2",
		"PAN-OS 10.2.7-h1",
		"PAN-OS 10.2.7",
		"PAN-OS 10.2.6",
		"PAN-OS 10.2.5",
		"PAN-OS 10.2.4-h4",
		"PAN-OS 10.2.4-h3",
		"PAN-OS 10.2.4-h2",
		"PAN-OS 10.2.4-h1",
		"PAN-OS 10.2.4",
		"PAN-OS 10.2.3-h11",
		"PAN-OS 10.2.3-h10",
		"PAN-OS 10.2.3-h9",
		"PAN-OS 10.2.3-h8",
		"PAN-OS 10.2.3-h7",
		"PAN-OS 10.2.3-h6",
		"PAN-OS 10.2.3-h5",
		"PAN-OS 10.2.3-h4",
		"PAN-OS 10.2.3-h3",
		"PAN-OS 10.2.3-h2",
		"PAN-OS 10.2.3-h1",
		"PAN-OS 10.2.3",
		"PAN-OS 10.2.2-h2",
		"PAN-OS 10.2.2-h1",
		"PAN-OS 10.2.2",
		"PAN-OS 10.2.1",
		"PAN-OS 10.2.0",
		"PAN-OS 10.2",
		"PAN-OS 10.1.13-h1",
		"PAN-OS 10.1.12",
		"PAN-OS 10.1.11-h5",
		"PAN-OS 10.1.11-h4",
		"PAN-OS 10.1.11-h3",
		"PAN-OS 10.1.11-h2",
		"PAN-OS 10.1.11-h1",
		"PAN-OS 10.1.11",
		"PAN-OS 10.1.10-h2",
		"PAN-OS 10.1.10-h1",
		"PAN-OS 10.1.10",
		"PAN-OS 10.1.9-h3",
		"PAN-OS 10.1.9-h2",
		"PAN-OS 10.1.9-h1",
		"PAN-OS 10.1.9",
		"PAN-OS 10.1.8-h6",
		"PAN-OS 10.1.8-h5",
		"PAN-OS 10.1.8-h4",
		"PAN-OS 10.1.8-h3",
		"PAN-OS 10.1.8-h2",
		"PAN-OS 10.1.8-h1",
		"PAN-OS 10.1.8",
		"PAN-OS 10.1.7",
		"PAN-OS 10.1.6-h7",
		"PAN-OS 10.1.6-h6",
		"PAN-OS 10.1.6-h5",
		"PAN-OS 10.1.6-h4",
		"PAN-OS 10.1.6-h3",
		"PAN-OS 10.1.6-h2",
		"PAN-OS 10.1.6-h1",
		"PAN-OS 10.1.6",
		"PAN-OS 10.1.5-h3",
		"PAN-OS 10.1.5-h2",
		"PAN-OS 10.1.5-h1",
		"PAN-OS 10.1.5",
		"PAN-OS 10.1.4-h4",
		"PAN-OS 10.1.4-h3",
		"PAN-OS 10.1.4-h2",
		"PAN-OS 10.1.4-h1",
		"PAN-OS 10.1.4",
		"PAN-OS 10.1.3-h2",
		"PAN-OS 10.1.3-h1",
		"PAN-OS 10.1.3",
		"PAN-OS 10.1.2",
		"PAN-OS 10.1.1",
		"PAN-OS 10.1.0",
		"PAN-OS 10.1",
		"PAN-OS 9.1.16-h3",
		"PAN-OS 9.1.16-h2",
		"PAN-OS 9.1.16-h1",
		"PAN-OS 9.1.16",
		"PAN-OS 9.1.15-h1",
		"PAN-OS 9.1.15",
		"PAN-OS 9.1.14-h7",
		"PAN-OS 9.1.14-h6",
		"PAN-OS 9.1.14-h5",
		"PAN-OS 9.1.14-h4",
		"PAN-OS 9.1.14-h3",
		"PAN-OS 9.1.14-h2",
		"PAN-OS 9.1.14-h1",
		"PAN-OS 9.1.14",
		"PAN-OS 9.1.13-h4",
		"PAN-OS 9.1.13-h3",
		"PAN-OS 9.1.13-h2",
		"PAN-OS 9.1.13-h1",
		"PAN-OS 9.1.13",
		"PAN-OS 9.1.12-h6",
		"PAN-OS 9.1.12-h5",
		"PAN-OS 9.1.12-h4",
		"PAN-OS 9.1.12-h3",
		"PAN-OS 9.1.12-h2",
		"PAN-OS 9.1.12-h1",
		"PAN-OS 9.1.12",
		"PAN-OS 9.1.11-h4",
		"PAN-OS 9.1.11-h3",
		"PAN-OS 9.1.11-h2",
		"PAN-OS 9.1.11-h1",
		"PAN-OS 9.1.11",
		"PAN-OS 9.1.10",
		"PAN-OS 9.1.9",
		"PAN-OS 9.1.8",
		"PAN-OS 9.1.7",
		"PAN-OS 9.1.6",
		"PAN-OS 9.1.5",
		"PAN-OS 9.1.4",
		"PAN-OS 9.1.3-h1",
		"PAN-OS 9.1.3",
		"PAN-OS 9.1.2-h1",
		"PAN-OS 9.1.2",
		"PAN-OS 9.1.1",
		"PAN-OS 9.1.0-h3",
		"PAN-OS 9.1.0-h2",
		"PAN-OS 9.1.0-h1",
		"PAN-OS 9.1.0",
		"PAN-OS 9.1",
		"Cloud NGFW"
	],
	"fixed": [
		"All",
		">= 11.1.3",
		">= 10.2.10",
		">= 10.1.14",
		">= 11.0.4-h5, >= 11.0.6",
		">= 9.1.19",
		"All",
		"None (Fix ETA: September 15)"
	],
	"date": "2024-07-10T16:00:00.000Z",
	"updated": "2024-07-26T05:00:00.000Z"
}
