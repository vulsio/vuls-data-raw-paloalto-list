{
	"id": "CVE-2024-3400",
	"title": "PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect",
	"problem": [
		{
			"lang": "en",
			"value": "A command injection as a result of arbitrary file creation vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurations may enable an unauthenticated attacker to execute arbitrary code with root privileges on the firewall.\n\nCloud NGFW, Panorama appliances, and Prisma Access are not impacted by this vulnerability.\n\nCustomers should continue to monitor this security advisory for the latest updates and product guidance."
		}
	],
	"solution": [
		{
			"lang": "en",
			"value": "We strongly advise customers to immediately upgrade to a fixed version of PAN-OS to protect their devices even when workarounds and mitigations have been applied.\n\nThis issue is fixed in PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions. These fixes and those listed below completely prevent the initial remote command execution, stopping subsequent post-exploitation or persistence.\n\nIn addition, to provide the most seamless upgrade path for customers, additional hotfixes have been made available as a courtesy for other commonly deployed maintenance releases.\n\n  PAN-OS 10.2:\n  - 10.2.9-h1 (Released 4/14/24)\n  - 10.2.8-h3 (Released 4/15/24)\n  - 10.2.7-h8 (Released 4/15/24)\n  - 10.2.6-h3 (Released 4/16/24)\n  - 10.2.5-h6 (Released 4/16/24)\n  - 10.2.4-h16 (Released 4/18/24)\n  - 10.2.3-h13 (Released 4/18/24)\n  - 10.2.2-h5 (Released 4/18/24)\n  - 10.2.1-h2 (Released 4/18/24)\n  - 10.2.0-h3 (Released 4/18/24)\n  \n  PAN-OS 11.0:\n  - 11.0.4-h1 (Released 4/14/24)\n  - 11.0.4-h2 (Released 4/17/24)\n  - 11.0.3-h10 (Released 4/16/24)\n  - 11.0.2-h4 (Released 4/16/24)\n  - 11.0.1-h4 (Released 4/18/24)\n  - 11.0.0-h3 (Released 4/18/24)\n  \n  PAN-OS 11.1:\n  - 11.1.2-h3 (Released 4/14/24)\n  - 11.1.1-h1 (Released 4/16/24)\n  - 11.1.0-h3 (Released 4/16/24)\n\nNote: Due to naming convention limitations, “-h” hotfix versions on Azure marketplace are instead named via addition of an extra “0”. Ex: 11.1.2-h3 is published on Azure as 11.1.203.\n\nIf any exploitation was observed on a device, please take the remediation steps suggested here: https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK\n\nAn enhanced factory reset (EFR) procedure that does not rely on the integrity of a potentially compromised device can be scheduled by opening a case through Customer Support (TAC). This is recommended for:\n1. Customers who have not applied the PAN-OS fixes or Threat Prevention signatures with vulnerability protection applied to the GlobalProtect interface (regardless of level of compromise) on or before April 25, 2024; or\n2. Customers who are concerned about a persistent risk.\n"
		}
	],
	"work_around": [
		{
			"lang": "en",
			"value": "Recommended Mitigation: Customers with a Threat Prevention subscription can block attacks for this vulnerability using Threat IDs 95187, 95189, and 95191 (available in Applications and Threats content version 8836-8695 and later). Please monitor this advisory and new Threat Prevention content updates for additional Threat Prevention IDs around CVE-2024-3400.\n\nTo apply the Threat IDs, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. Please see https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184 for more information.\n\nIn earlier versions of this advisory, disabling device telemetry was listed as a secondary mitigation action. Disabling device telemetry is no longer an effective mitigation. Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability."
		}
	],
	"severity": "CRITICAL",
	"base_severity": "",
	"base_score": 0,
	"threat_severity": "",
	"show_cvss_in_header": true,
	"AV": "NETWORK",
	"AC": "LOW",
	"PR": "NONE",
	"UI": "NONE",
	"C": "product:HIGH subsequent:HIGH",
	"I": "product:HIGH subsequent:HIGH",
	"A": "product:HIGH subsequent:HIGH",
	"product": [
		"PAN-OS",
		"Cloud NGFW",
		"Prisma Access"
	],
	"version": [
		"Prisma Access ",
		"PAN-OS 11.1",
		"PAN-OS 11.0",
		"PAN-OS 10.2",
		"PAN-OS 10.1",
		"PAN-OS 10.0",
		"PAN-OS 9.1",
		"PAN-OS 9.0",
		"Cloud NGFW "
	],
	"affected": [
		"",
		"< 11.1.0-h3, < 11.1.1-h1, < 11.1.2-h3",
		"< 11.0.0-h3, < 11.0.1-h4, < 11.0.2-h4, < 11.0.3-h10, < 11.0.4-h1",
		"< 10.2.0-h3, < 10.2.1-h2, < 10.2.2-h5, < 10.2.3-h13, < 10.2.4-h16, < 10.2.5-h6, < 10.2.6-h3, < 10.2.7-h8, < 10.2.8-h3, < 10.2.9-h1",
		"",
		"",
		"",
		"",
		""
	],
	"affected_list": [
		"PAN-OS 11.1.2-h2",
		"PAN-OS 11.1.2-h1",
		"PAN-OS 11.1.2",
		"PAN-OS 11.1.0-h2",
		"PAN-OS 11.1.0-h1",
		"PAN-OS 11.1.0",
		"PAN-OS 11.1",
		"PAN-OS 11.0.4",
		"PAN-OS 11.0.3-h9",
		"PAN-OS 11.0.3-h8",
		"PAN-OS 11.0.3-h7",
		"PAN-OS 11.0.3-h6",
		"PAN-OS 11.0.3-h5",
		"PAN-OS 11.0.3-h4",
		"PAN-OS 11.0.3-h3",
		"PAN-OS 11.0.3-h2",
		"PAN-OS 11.0.3-h1",
		"PAN-OS 11.0.3",
		"PAN-OS 11.0.2-h3",
		"PAN-OS 11.0.2-h2",
		"PAN-OS 11.0.2-h1",
		"PAN-OS 11.0.2",
		"PAN-OS 11.0.1-h3",
		"PAN-OS 11.0.1-h2",
		"PAN-OS 11.0.1-h1",
		"PAN-OS 11.0.1",
		"PAN-OS 11.0.0-h2",
		"PAN-OS 11.0.0-h1",
		"PAN-OS 11.0.0",
		"PAN-OS 11.0",
		"PAN-OS 10.2.9",
		"PAN-OS 10.2.7-h7",
		"PAN-OS 10.2.7-h6",
		"PAN-OS 10.2.7-h5",
		"PAN-OS 10.2.7-h4",
		"PAN-OS 10.2.7-h3",
		"PAN-OS 10.2.7-h2",
		"PAN-OS 10.2.7-h1",
		"PAN-OS 10.2.7",
		"PAN-OS 10.2.6-h2",
		"PAN-OS 10.2.6-h1",
		"PAN-OS 10.2.6",
		"PAN-OS 10.2.5-h5",
		"PAN-OS 10.2.5-h4",
		"PAN-OS 10.2.5-h3",
		"PAN-OS 10.2.5-h2",
		"PAN-OS 10.2.5-h1",
		"PAN-OS 10.2.5",
		"PAN-OS 10.2.4-h15",
		"PAN-OS 10.2.4-h14",
		"PAN-OS 10.2.4-h13",
		"PAN-OS 10.2.4-h12",
		"PAN-OS 10.2.4-h11",
		"PAN-OS 10.2.4-h10",
		"PAN-OS 10.2.4-h9",
		"PAN-OS 10.2.4-h8",
		"PAN-OS 10.2.4-h7",
		"PAN-OS 10.2.4-h6",
		"PAN-OS 10.2.4-h5",
		"PAN-OS 10.2.4-h4",
		"PAN-OS 10.2.4-h3",
		"PAN-OS 10.2.4-h2",
		"PAN-OS 10.2.4-h1",
		"PAN-OS 10.2.4",
		"PAN-OS 10.2.3-h12",
		"PAN-OS 10.2.3-h11",
		"PAN-OS 10.2.3-h10",
		"PAN-OS 10.2.3-h9",
		"PAN-OS 10.2.3-h8",
		"PAN-OS 10.2.3-h7",
		"PAN-OS 10.2.3-h6",
		"PAN-OS 10.2.3-h5",
		"PAN-OS 10.2.3-h4",
		"PAN-OS 10.2.3-h3",
		"PAN-OS 10.2.3-h2",
		"PAN-OS 10.2.3-h1",
		"PAN-OS 10.2.3",
		"PAN-OS 10.2.2-h4",
		"PAN-OS 10.2.2-h3",
		"PAN-OS 10.2.2-h2",
		"PAN-OS 10.2.2-h1",
		"PAN-OS 10.2.2",
		"PAN-OS 10.2.1-h1",
		"PAN-OS 10.2.1",
		"PAN-OS 10.2.0-h2",
		"PAN-OS 10.2.0-h1",
		"PAN-OS 10.2.0",
		"PAN-OS 10.2"
	],
	"fixed": [
		"All",
		">= 11.1.0-h3, >= 11.1.1-h1, >= 11.1.2-h3",
		">= 11.0.0-h3, >= 11.0.1-h4, >= 11.0.2-h4, >= 11.0.3-h10, >= 11.0.4-h1",
		">= 10.2.0-h3, >= 10.2.1-h2, >= 10.2.2-h5, >= 10.2.3-h13, >= 10.2.4-h16, >= 10.2.5-h6, >= 10.2.6-h3, >= 10.2.7-h8, >= 10.2.8-h3, >= 10.2.9-h1",
		"All",
		"All",
		"All",
		"All",
		"All"
	],
	"date": "2024-04-12T06:55:00.000Z",
	"updated": "2024-05-03T04:50:00.000Z"
}
