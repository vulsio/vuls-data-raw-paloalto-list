{
	"id": "CVE-2024-3661",
	"title": "Impact of TunnelVision Vulnerability",
	"problem": [
		{
			"lang": "en",
			"value": "The Palo Alto Networks Product Security Assurance team has evaluated the TunnelVision vulnerability as it relates to our products. This issue allows an attacker with the ability to send DHCP messages on the same local area network, such as a rogue Wi-Fi network, to leak traffic outside of the GlobalProtect tunnel, allowing the attacker to read, disrupt, or possibly modify network traffic that was expected to be protected by the GlobalProtect tunnel. However, this attack does not enable the attacker to decrypt HTTPS or other encrypted traffic.\n\nCloud NGFW, PAN-OS, and Prisma Access do not process DHCP option 121 and are therefore unaffected.\n\nGlobalProtect app on Windows and macOS systems with Endpoint Traffic Policy Enforcement enabled are unaffected. Endpoint Traffic Policy Enforcement is disabled by default.\n\nGlobalProtect app on Linux is affected. A fix will be released in an upcoming release.\n\nGlobalProtect app on iOS with IncludeAllNetworks set to 1 is unaffected.\n\nGlobalProtect app on Android is unaffected since the Android DHCP client does not process DHCP option 121."
		}
	],
	"solution": [
		{
			"lang": "en",
			"value": "For Windows and macOS devices, ensure that Endpoint Traffic Policy Enforcement is set to All Traffic (Network → GlobalProtect Portals → <portal-config> → Agent → <agent-config> → App → Endpoint Traffic Policy Enforcement). Please see the following document for additional details: https://docs.paloaltonetworks.com/globalprotect/6-0/globalprotect-app-new-features/new-features-released-in-gp-app/endpoint-traffic-policy-enforcement.\n\nFor iOS devices, ensure that IncludeAllNetworks is set to 1 using mobile device management. For additional guidance, please see our mobile device management documentation at https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/mobile-endpoint-management and the Apple documentation at https://developer.apple.com/documentation/devicemanagement/vpn/vpn. To allow users to access their local network, ensure that ExcludeLocalNetwork is set to 1, so that the GlobalProtect app will route all local network traffic outside the tunnel.\n\nUpdates will be released for the GlobalProtect app on Linux in an upcoming major release."
		}
	],
	"work_around": [
		{
			"lang": "en",
			"value": "For the GlobalProtect app on Windows, macOS, and Linux, this attack can be mitigated by enabling the \"No direct access to local network\" feature in the Split Tunnel tab on the firewall. Detailed information can be found at:\n\n\n\n * https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-web-interface-help/globalprotect/network-globalprotect-gateways/globalprotect-gateways-agent-tab/client-settings-tab\n * https://docs.paloaltonetworks.com/prisma/prisma-access/3-0/prisma-access-panorama-admin/prisma-access-advanced-deployments/mobile-user-globalprotect-advanced-deployments/sinkhole-ipv6-traffic-from-mobile-users/configure-globalprotect-to-disable-direct-access-to-the-local-network\n\n\n\nNote that enabling \"No direct access to local network\" prevents end users from connecting to local LAN devices such as home printers, network storage, or streaming devices. You can configure exceptions for specific users, operating systems, source addresses, destination domains, and applications by following the instructions at:\n\n\n\n * https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-access-route\n * https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-domain-and-application\n\n\n\nYou can mitigate this attack for the GlobalProtect app on iOS devices by disabling Wi-Fi."
		}
	],
	"severity": "LOW",
	"base_severity": "",
	"base_score": 0,
	"threat_severity": "",
	"show_cvss_in_header": true,
	"AV": "ADJACENT_NETWORK",
	"AC": "HIGH",
	"PR": "NONE",
	"UI": "PASSIVE",
	"C": "product:LOW subsequent:NONE",
	"I": "product:LOW subsequent:NONE",
	"A": "product:LOW subsequent:NONE",
	"product": [
		"Cloud NGFW",
		"GlobalProtect App",
		"GlobalProtect App",
		"GlobalProtect App",
		"GlobalProtect App",
		"PAN-OS",
		"Prisma Access"
	],
	"version": [
		"Cloud NGFW",
		"GlobalProtect App",
		"PAN-OS",
		"Prisma Access"
	],
	"affected": [
		"None",
		"All without Endpoint Traffic Policy Enforcement set to All Traffic on Windows, All without Endpoint Traffic Policy Enforcement set to All Traffic on macOS, All on Linux, All without IncludeAllNetworks set to 1 on iOS, None on Android",
		"None",
		"None"
	],
	"affected_list": [
		"GlobalProtect app on Windows and macOS",
		"GlobalProtect app on Linux",
		"GlobalProtect app on iOS"
	],
	"fixed": [
		"All",
		"All with Endpoint Traffic Policy Enforcement set to All Traffic on Windows, All with Endpoint Traffic Policy Enforcement set to All Traffic on macOS, Upcoming major release on Linux, All with IncludeAllNetworks set to 1 on iOS, All on Android",
		"All",
		"All"
	],
	"date": "2024-05-16T16:00:00.000Z",
	"updated": "2024-05-16T16:00:00.000Z"
}
