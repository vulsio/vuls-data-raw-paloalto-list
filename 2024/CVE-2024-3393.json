{
	"id": "CVE-2024-3393",
	"title": "PAN-OS: Firewall Denial of Service (DoS) in DNS Security Using a Specially Crafted Packet",
	"problem": [
		{
			"lang": "en",
			"value": "A Denial of Service vulnerability in the DNS Security feature of Palo Alto Networks PAN-OS software allows an unauthenticated attacker to send a malicious packet through the data plane of the firewall that reboots the firewall. Repeated attempts to trigger this condition will cause the firewall to enter maintenance mode.\n\nThis issue is applicable to the PAN-OS software versions listed below on PA-Series firewalls, VM-Series firewalls, CN-Series firewalls, and Prisma Access."
		}
	],
	"solution": [
		{
			"lang": "eng",
			"value": "This issue is fixed in PAN-OS 10.1.15, PAN-OS 10.2.14, PAN-OS 11.1.5, PAN-OS 11.2.3, and all later PAN-OS versions.\n\nNote: PAN-OS 11.0 reached the end of life (EOL) on November 17, 2024, so we do not intend to provide a fix for this release.\n\nPrisma Access customers using DNS Security with affected PAN-OS versions should apply one of the workarounds provided below. We will perform upgrades in two phases for impacted customers on the weekends of January 3rd and January 10th. You can request an expedited Prisma Access upgrade to the latest PAN-OS version by opening a support case (https://support.paloaltonetworks.com/Support/Index).\n\nIn addition, to provide the most seamless upgrade path for our customers, we are making fixes available for other TAC-preferred and commonly deployed maintenance releases.\n\nAdditional PAN-OS 11.1 releases with the fix:\n\n * 11.1.2-h16 (available)\n * 11.1.3-h13 (available)\n * 11.1.4-h7 (available)\n * 11.1.5 (available)\n\nAdditional PAN-OS 10.2 releases with the fix:\n * 10.2.8-h19 (available)\n * 10.2.9-h19 (available)\n * 10.2.10-h12 (available)\n * 10.2.11-h10 (available)\n * 10.2.12-h4 (available)\n * 10.2.13-h2 (available)\n * 10.2.14 (ETA: early March)\n\nAdditional PAN-OS 10.1 releases with the fix:\n * 10.1.14-h8 (available)\n * 10.1.15 (ETA: end of February)\n\nAdditional PAN-OS releases with the fix only applicable to Prisma Access:\n * 10.2.9-h19 (available)\n * 10.2.10-h12 (available)"
		}
	],
	"work_around": [
		{
			"lang": "en",
			"value": "If your firewall running the vulnerable PAN-OS versions stops responding or reboots unexpectedly and you cannot immediately apply a fix, apply a workaround below based on your deployment.\n\nUnmanaged NGFWs, NGFW managed by Panorama, or Prisma Access managed by Panorama\n\n 1. Ensure that a DNS Security Configuration is already present in the device's configuration. See the \"Required Configuration for Exposure\" section for details.\n 2. Within Objects → Security Profiles (https://docs.paloaltonetworks.com/pan-os/11-2/pan-os-web-interface-help/objects/objects-security-profiles-anti-spyware-profile), determine if you use the predefined Anti-Spyware profiles (https://docs.paloaltonetworks.com/network-security/security-policy/administration/security-profiles/security-profile-anti-spyware) in your Security Policy. These are named \"Default\" or \"Strict\" (https://docs.paloaltonetworks.com/network-security/security-policy/administration/security-profiles/security-profile-anti-spyware). If you are using the predefined security profiles, clone the predefined Anti-Spyware profile (https://docs.paloaltonetworks.com/pan-os/11-2/pan-os-web-interface-help/objects/move-clone-override-or-revert-objects/move-or-clone-an-object) for use as a custom Anti-Spyware profile. After cloning each relevant predefined Anti-Spyware profile, replace them with the cloned custom Anti-Spyware profile or group in your Security Rules (Policies → Security → (security rule) in either Actions → Profiles or Actions → Group (https://docs.paloaltonetworks.com/network-security/security-policy/administration/security-rules/create-a-security-policy-rule#create-a-security-policy-rule-panorama)).\n    \n 3. For each custom Anti-Spyware profile, navigate to Objects → Security Profiles → Anti-Spyware → (select a custom profile) → DNS Policies → DNS Security.\n 4. Change the Log Severity to \"none\" for all configured DNS Security categories.\n    \n    \n    \n 5. Commit the changes.\n\nNote 1: Setting Log Severity to 'none' for devices that didn't have a DNS Security configuration may block DNS traffic that wasn’t previously blocked. Additionally, this may happen without generating any log entries, making it difficult to detect the blocked traffic. Review the Required Configuration for Exposure section for instructions on identifying existing DNS Security Configuration.\n\nNote 2: Remember to revert the Log Severity settings once the fixes are applied.\n\nNGFW managed by Strata Cloud Manager (SCM)\n\n\nYou can choose one of the following mitigation options:\n 1. Option 1: Disable DNS Security logging directly on each NGFW by following the PAN-OS steps above.\n 2. Option 2: Disable DNS Security logging across all NGFWs in your tenant by opening a support case (https://support.paloaltonetworks.com/Support/Index).\n\nPrisma Access managed by Strata Cloud Manager (SCM)\n\nUntil we perform an upgrade of your Prisma Access tenant, you can disable DNS Security logging across all NGFWs in your tenant by opening a support case (https://support.paloaltonetworks.com/Support/Index). If you would like to expedite the upgrade, please make a note of that in the support case."
		}
	],
	"severity": "HIGH",
	"base_severity": "",
	"base_score": 0,
	"threat_severity": "",
	"show_cvss_in_header": true,
	"AV": "NETWORK",
	"AC": "LOW",
	"PR": "NONE",
	"UI": "NONE",
	"C": "product:NONE subsequent:NONE",
	"I": "product:NONE subsequent:NONE",
	"A": "product:HIGH subsequent:LOW",
	"product": [
		"Cloud NGFW",
		"PAN-OS",
		"PAN-OS",
		"PAN-OS"
	],
	"version": [
		"Cloud NGFW",
		"PAN-OS 11.2",
		"PAN-OS 11.1",
		"PAN-OS 10.2",
		"PAN-OS 10.1",
		"PAN-OS 10.0",
		"PAN-OS 9.1",
		"Prisma Access",
		"PAN-OS"
	],
	"affected": [
		"None",
		"< 11.2.3",
		"< 11.1.2-h16, < 11.1.3-h13, < 11.1.4-h7, < 11.1.5",
		">= 10.2.8, < 10.2.8-h19, < 10.2.9-h19, < 10.2.10-h12, < 10.2.11-h10, < 10.2.12-h4, < 10.2.13-h2, < 10.2.14",
		">= 10.1.14, < 10.1.14-h8, < 10.1.15",
		"None",
		"None",
		">= 10.2.8 on PAN-OS, < 10.2.9-h19 on PAN-OS, < 10.2.10-h12 on PAN-OS, < 11.2.3 on PAN-OS",
		"None on Panorama"
	],
	"affected_list": [
		"PAN-OS 11.2.2-h2",
		"PAN-OS 11.2.2-h1",
		"PAN-OS 11.2.1-h1",
		"PAN-OS 11.2.1",
		"PAN-OS 11.2.0-h1",
		"PAN-OS 11.2.0",
		"PAN-OS 11.1.4-h6",
		"PAN-OS 11.1.4-h5",
		"PAN-OS 11.1.4-h4",
		"PAN-OS 11.1.4-h3",
		"PAN-OS 11.1.4-h2",
		"PAN-OS 11.1.4-h1",
		"PAN-OS 11.1.4",
		"PAN-OS 11.1.3-h12",
		"PAN-OS 11.1.3-h11",
		"PAN-OS 11.1.3-h10",
		"PAN-OS 11.1.3-h9",
		"PAN-OS 11.1.3-h8",
		"PAN-OS 11.1.3-h7",
		"PAN-OS 11.1.3-h6",
		"PAN-OS 11.1.3-h5",
		"PAN-OS 11.1.3-h4",
		"PAN-OS 11.1.3-h3",
		"PAN-OS 11.1.3-h2",
		"PAN-OS 11.1.3-h1",
		"PAN-OS 11.1.3",
		"PAN-OS 11.1.2-h15",
		"PAN-OS 11.1.2-h14",
		"PAN-OS 11.1.2-h13",
		"PAN-OS 11.1.2-h12",
		"PAN-OS 11.1.2-h11",
		"PAN-OS 11.1.2-h10",
		"PAN-OS 11.1.2-h9",
		"PAN-OS 11.1.2-h8",
		"PAN-OS 11.1.2-h7",
		"PAN-OS 11.1.2-h6",
		"PAN-OS 11.1.2-h5",
		"PAN-OS 11.1.2-h4",
		"PAN-OS 11.1.2-h3",
		"PAN-OS 11.1.2-h2",
		"PAN-OS 11.1.2-h1",
		"PAN-OS 11.1.2",
		"PAN-OS 11.1.1-h2",
		"PAN-OS 11.1.1-h1",
		"PAN-OS 11.1.1",
		"PAN-OS 11.1.0-h4",
		"PAN-OS 11.1.0-h3",
		"PAN-OS 11.1.0-h2",
		"PAN-OS 11.1.0-h1",
		"PAN-OS 11.1.0",
		"PAN-OS 10.2.13-h1",
		"PAN-OS 10.2.13",
		"PAN-OS 10.2.12-h3",
		"PAN-OS 10.2.12-h2",
		"PAN-OS 10.2.12-h1",
		"PAN-OS 10.2.12",
		"PAN-OS 10.2.11-h9",
		"PAN-OS 10.2.11-h8",
		"PAN-OS 10.2.11-h7",
		"PAN-OS 10.2.11-h6",
		"PAN-OS 10.2.11-h5",
		"PAN-OS 10.2.11-h4",
		"PAN-OS 10.2.11-h3",
		"PAN-OS 10.2.11-h2",
		"PAN-OS 10.2.11-h1",
		"PAN-OS 10.2.11",
		"PAN-OS 10.2.10-h11",
		"PAN-OS 10.2.10-h10",
		"PAN-OS 10.2.10-h9",
		"PAN-OS 10.2.10-h8",
		"PAN-OS 10.2.10-h7",
		"PAN-OS 10.2.10-h6",
		"PAN-OS 10.2.10-h5",
		"PAN-OS 10.2.10-h4",
		"PAN-OS 10.2.10-h3",
		"PAN-OS 10.2.10-h2",
		"PAN-OS 10.2.10-h1",
		"PAN-OS 10.2.10",
		"PAN-OS 10.2.9-h18",
		"PAN-OS 10.2.9-h17",
		"PAN-OS 10.2.9-h16",
		"PAN-OS 10.2.9-h15",
		"PAN-OS 10.2.9-h14",
		"PAN-OS 10.2.9-h13",
		"PAN-OS 10.2.9-h12",
		"PAN-OS 10.2.9-h11",
		"PAN-OS 10.2.9-h10",
		"PAN-OS 10.2.9-h9",
		"PAN-OS 10.2.9-h8",
		"PAN-OS 10.2.9-h7",
		"PAN-OS 10.2.9-h6",
		"PAN-OS 10.2.9-h5",
		"PAN-OS 10.2.9-h4",
		"PAN-OS 10.2.9-h3",
		"PAN-OS 10.2.9-h2",
		"PAN-OS 10.2.9-h1",
		"PAN-OS 10.2.9",
		"PAN-OS 10.2.8-h18",
		"PAN-OS 10.2.8-h17",
		"PAN-OS 10.2.8-h16",
		"PAN-OS 10.2.8-h15",
		"PAN-OS 10.2.8-h14",
		"PAN-OS 10.2.8-h13",
		"PAN-OS 10.2.8-h12",
		"PAN-OS 10.2.8-h11",
		"PAN-OS 10.2.8-h10",
		"PAN-OS 10.2.8-h9",
		"PAN-OS 10.2.8-h8",
		"PAN-OS 10.2.8-h7",
		"PAN-OS 10.2.8-h6",
		"PAN-OS 10.2.8-h5",
		"PAN-OS 10.2.8-h4",
		"PAN-OS 10.2.8-h3",
		"PAN-OS 10.2.8-h2",
		"PAN-OS 10.2.8-h1",
		"PAN-OS 10.2.8",
		"PAN-OS 10.1.14-h7",
		"PAN-OS 10.1.14-h6",
		"PAN-OS 10.1.14-h5",
		"PAN-OS 10.1.14-h4",
		"PAN-OS 10.1.14-h3",
		"PAN-OS 10.1.14-h2",
		"PAN-OS 10.1.14-h1",
		"PAN-OS 10.1.14"
	],
	"fixed": [
		"All",
		">= 11.2.3",
		">= 11.1.2-h16, >= 11.1.3-h13, >= 11.1.4-h7, >= 11.1.5",
		"< 10.2.8, >= 10.2.8-h19, >= 10.2.9-h19, >= 10.2.10-h12, >= 10.2.11-h10, >= 10.2.12-h4, >= 10.2.13-h2, >= 10.2.14",
		"< 10.1.14, >= 10.1.14-h8, >= 10.1.15",
		"All",
		"All",
		"< 10.2.8 on PAN-OS, >= 10.2.9-h19 on PAN-OS, >= 10.2.10-h12 on PAN-OS, >= 11.2.3 on PAN-OS",
		"All on Panorama"
	],
	"date": "2024-12-27T02:30:00.000Z",
	"updated": "2025-01-30T00:00:00.000Z"
}
