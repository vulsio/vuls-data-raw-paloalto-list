{
	"id": "CVE-2024-5921",
	"title": "GlobalProtect App: Insufficient Certificate Validation Leads to Privilege Escalation",
	"problem": [
		{
			"lang": "en",
			"value": "An insufficient certification validation issue in the Palo Alto Networks GlobalProtect app enables attackers to connect the GlobalProtect app to arbitrary servers. This can enable a local non-administrative operating system user or an attacker on the same subnet to install malicious root certificates on the endpoint and subsequently install malicious software signed by the malicious root certificates on that endpoint.\n\nPlease subscribe to our RSS feed (https://security.paloaltonetworks.com/rss.xml) to be alerted to new updates to this and other advisories."
		}
	],
	"solution": [
		{
			"lang": "eng",
			"value": "This issue is fixed in GlobalProtect app 6.2.1-c31 on Linux, GlobalProtect app 6.2.6 on Windows, GlobalProtect app 6.2.6-c857 on macOS, GlobalProtect app 6.3.2 on Windows and macOS, and all later GlobalProtect app versions. Additional fixes are under development and will be made available for the remaining platforms (Linux, iOS, and Android).\n\nThe fix for this vulnerability requires three steps:\n\n 1. Ensure that all of your GlobalProtect portals use TLS certificate chains that meet the criteria specified in the \"FIPS-CC Certification Validation\" table in our documentation (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues).\n 2. Ensure that the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system.\n 3. Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.\n    \n\nNote: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.\n\nImportant: If your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in our documentation (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues).\n\n\nWarning: Performance Concern: Some customers reported problems connecting to Portals and Gateways when this solution was implemented in certain situations. This is due to certificate providers that rate limit requests for Online Certificate Status Protocol (OCSP) and certificate revocation list (CRL) checks. This happens when multiple users connect to GlobalProtect Portals from a single public IP (such as NAT) around the same time, such as when hundreds or thousands of end users connect around the start of a workday from a single office.\n\n\nSolution for new and existing GlobalProtect app installations on Windows\n\nCustomers can use their endpoint mobile device management (MDM) tools to apply the following changes.\n\n 1. Install a fixed version of GlobalProtect app.\n 2. Update the following registry key with the specified recommended values (these values have the REG_SZ type):\n    [HKEY_LOCAL_MACHINE\\SOFTWARE\\Palo Alto Networks\\GlobalProtect\\Settings]\n    \"cert-store\"=\"machine\"\n    \"cert-location\"=\"ROOT\"\n    \"full-chain-cert-verify\"=\"yes\"\n 3. To apply this registry change, restart Windows.\n\nAlternate solution for new GlobalProtect app installations on Windows\n\nInstall the GlobalProtect app with the pre-deployment key FULLCHAINCERTVERIFY set to Yes:\n\n> msiexec.exe /i GlobalProtect64.msi FULLCHAINCERTVERIFY=\"yes\"\n\nNote: This command will add the registry values listed in the previous section (no additional MSI options are needed).\n\n\nSolution for new and existing GlobalProtect app installations on macOS\n\n 1. Install a fixed version of the GlobalProtect app.\n 2. Use Xcode to edit the com.paloaltonetworks.GlobalProtect.settings.plist file (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-apps/deploy-app-settings-transparently/deploy-app-settings-to-mac-endpoints/deploy-app-settings-in-the-mac-plist) in /Library/Preferences.\n 3. Add a \"Settings\" section if it does not exist within the GlobalProtect section.\n 4. Within the \"Settings\" section, add the full-chain-cert-verify key and set the string value to yes.\n    <key>GlobalProtect</key>\n    <dict>\n        (removed for brevity)\n        <key>Settings</key>\n        <dict>\n            <key>full-chain-cert-verify</key>\n            <string>yes</string>\n        </dict>\n    </dict>\n 5. Restart macOS.\n\nSolution for new and existing GlobalProtect app installations on Linux\n\n 1. Create the /opt/paloaltonetworks/globalprotect/pangps.xml pre-deployment configuration file.\n 2. Add the pre-deployment settings to the pangps.xml file:\n    <GlobalProtect>\n        <Settings>\n            <full-chain-cert-verify>yes</full-chain-cert-verify>\n        </Settings>\n    </GlobalProtect>\n 3. Install a fixed version of GlobalProtect app.\n\nSolution for new and existing GlobalProtect app installations on Android and iOS\n\nCustomers can use their endpoint mobile device management (MDM) tools to apply the following changes.\n 1. Set the key \"full-chain-cert-verify\"=\"yes\". \n 2. Install a fixed version of GlobalProtect app for Android or iOS.\n"
		}
	],
	"work_around": [
		{
			"lang": "en",
			"value": "You can mitigate this issue for all platforms (Windows (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry), macOS (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list), Linux (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat), iOS (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices), Android (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints)) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, refer to the first \"FIPS-CC Certification Validation\" table in our documentation (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues).\n\nNote: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround."
		}
	],
	"severity": "MEDIUM",
	"base_severity": "",
	"base_score": 0,
	"threat_severity": "",
	"show_cvss_in_header": true,
	"AV": "ADJACENT_NETWORK",
	"AC": "LOW",
	"PR": "NONE",
	"UI": "PASSIVE",
	"C": "product:NONE subsequent:HIGH",
	"I": "product:HIGH subsequent:HIGH",
	"A": "product:NONE subsequent:HIGH",
	"product": [
		"GlobalProtect App",
		"GlobalProtect App",
		"GlobalProtect App",
		"GlobalProtect App",
		"GlobalProtect App",
		"GlobalProtect App",
		"GlobalProtect App"
	],
	"version": [
		"GlobalProtect App 6.3",
		"GlobalProtect App 6.2",
		"GlobalProtect App 6.1",
		"GlobalProtect App 6.0",
		"GlobalProtect App 5.1"
	],
	"affected": [
		"< 6.3.2* on Windows, < 6.3.2* on macOS",
		"< 6.2.6* on Windows, < 6.2.6-c857* on macOS, < 6.2.1-c31* on Linux, < 6.2.6* on Windows UWP",
		"All on Windows, All on macOS, All on Linux, < 6.1.6* on Android, < 6.1.7* on iOS",
		"None on FIPS-CC mode",
		"None on FIPS-CC mode"
	],
	"affected_list": [
		"GlobalProtect App 6.3.1",
		"GlobalProtect App 6.3.0",
		"GlobalProtect App 6.3",
		"GlobalProtect App 6.2.4",
		"GlobalProtect App 6.2.3",
		"GlobalProtect App 6.2.2",
		"GlobalProtect App 6.2.1",
		"GlobalProtect App 6.2.0",
		"GlobalProtect App 6.2"
	],
	"fixed": [
		">= 6.3.2* on Windows, >= 6.3.2* on macOS",
		">= 6.2.6* on Windows, >= 6.2.6-c857* on macOS, >= 6.2.1-c31* on Linux, >= 6.2.6* on Windows UWP (ETA: end of April)",
		"None on Windows, None on macOS, None on Linux, >= 6.1.6* on Android, >= 6.1.7* on iOS",
		"All on FIPS-CC mode",
		"All on FIPS-CC mode"
	],
	"date": "2024-11-26T02:45:00.000Z",
	"updated": "2025-03-19T19:40:00.000Z"
}
