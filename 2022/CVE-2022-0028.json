{
	"id": "CVE-2022-0028",
	"title": "PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering",
	"problem": [
		{
			"lang": "en",
			"value": "A PAN-OS URL filtering policy misconfiguration could allow a network-based attacker to conduct reflected and amplified TCP denial-of-service (RDoS) attacks. The DoS attack would appear to originate from a Palo Alto Networks PA-Series (hardware), VM-Series (virtual) and CN-Series (container) firewall against an attacker-specified target.\n\nTo be misused by an external attacker, the firewall configuration must have a URL filtering profile with one or more blocked categories assigned to a security rule with a source zone that has an external facing network interface. This configuration is not typical for URL filtering and, if set, is likely unintended by the administrator.\n\nIf exploited, this issue would not impact the confidentiality, integrity, or availability of our products. However, the resulting denial-of-service (DoS) attack may help obfuscate the identity of the attacker and implicate the firewall as the source of the attack.\n\nWe have taken prompt action to address this issue in our PAN-OS software. All PAN-OS software updates for this issue are now available. This issue does not impact Panorama M-Series or Panorama virtual appliances.\n\nThis issue has been resolved for all Cloud NGFW and Prisma Access customers and no additional action is required from them."
		}
	],
	"solution": [
		{
			"lang": "en",
			"value": "We identified workarounds to prevent the denial-of-service (DoS) attacks that result from this issue in certain Palo Alto Networks firewalls, with this policy configuration.\n\nThis issue is fixed in PAN-OS 8.1.23-h1, PAN-OS 9.0.16-h3, PAN-OS 9.1.14-h4, PAN-OS 10.0.11-h1, PAN-OS 10.1.6-h6, PAN-OS 10.2.2-h2, and all later PAN-OS versions for PA-Series, VM-Series and CN-Series firewalls.\n\nAll PAN-OS software updates for this issue are now available."
		}
	],
	"work_around": [
		{
			"lang": "en",
			"value": "If you have a URL filtering policy with one or more blocked categories assigned to a security rule with a source zone that has an external facing interface, removing this configuration will prevent this issue from being exploited by remote attackers to conduct reflected DoS.\n\nTo prevent denial-of-service (DoS) attacks resulting from this issue from all sources, you can configure your Palo Alto Networks firewalls by enabling one of two zone protection mitigations on all Security zones with an assigned Security policy that includes a URL filtering profile:\n\n1. Packet-based attack protection including both (Packet Based Attack Protection > TCP Drop > TCP SYN with Data) and (Packet Based Attack Protection > TCP Drop > Strip TCP Options > TCP Fast Open);\nOR\n2. Flood protection (Flood Protection > SYN > Action > SYN Cookie) with an activation threshold of 0 connections.\n\nNOTES:\nIt is not necessary nor advantageous to apply both the attack and flood protections. \n(Palo Alto Networks Aporeto software only) You should not enable either of these protections if using Aporeto software; instead, wait for and install a fixed version of PAN-OS software.\n\nPacket-Based Attack Protection Workaround (Recommended)\n\nFollow the technical documentation to configure packet-based attack protection options for all defined Security zones with URL filtering enabled in the Security profile for that zone:\nhttps://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/configure-zone-protection-to-increase-network-security/configure-packet-based-attack-protection\n\nThe packet-based attack protection workaround will prevent the firewall from establishing TCP sessions in impacted zones when the TCP SYN packet contains data in the three-way handshake for a TCP session. Please note that this workaround may disrupt applications that use TCP Fast Open in the zone.\n\nFlood Protection (Alternate) Workaround\n\nIf you instead decide to enable the flood protection workaround, first make sure you understand how  enabling SYN cookies will change traffic flow in the impacted zones:\nhttps://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/zone-defense/zone-protection-profiles/flood-protection"
		}
	],
	"severity": "HIGH",
	"base_severity": "",
	"base_score": 0,
	"threat_severity": "",
	"show_cvss_in_header": true,
	"AV": "NETWORK",
	"AC": "LOW",
	"PR": "NONE",
	"UI": "NONE",
	"C": "NONE",
	"I": "NONE",
	"A": "HIGH",
	"product": [
		"Cloud NGFW",
		"PAN-OS",
		"Prisma Access"
	],
	"version": [
		"Prisma Access 3.1",
		"Prisma Access 3.0",
		"Prisma Access 2.2",
		"Prisma Access 2.1",
		"PAN-OS 10.2",
		"PAN-OS 10.1",
		"PAN-OS 10.0",
		"PAN-OS 9.1",
		"PAN-OS 9.0",
		"PAN-OS 8.1",
		"Cloud NGFW "
	],
	"affected": [
		"",
		"",
		"",
		"",
		"< 10.2.2-h2",
		"< 10.1.6-h6",
		"< 10.0.11-h1",
		"< 9.1.14-h4",
		"< 9.0.16-h3",
		"< 8.1.23-h1",
		""
	],
	"affected_list": [
		"PAN-OS 10.2.2-h1",
		"PAN-OS 10.2.2",
		"PAN-OS 10.2.1",
		"PAN-OS 10.2.0",
		"PAN-OS 10.2",
		"PAN-OS 10.1.6-h5",
		"PAN-OS 10.1.6-h4",
		"PAN-OS 10.1.6-h3",
		"PAN-OS 10.1.6-h2",
		"PAN-OS 10.1.6-h1",
		"PAN-OS 10.1.6",
		"PAN-OS 10.1.5-h2",
		"PAN-OS 10.1.5-h1",
		"PAN-OS 10.1.5",
		"PAN-OS 10.1.4-h4",
		"PAN-OS 10.1.4-h3",
		"PAN-OS 10.1.4-h2",
		"PAN-OS 10.1.4-h1",
		"PAN-OS 10.1.4",
		"PAN-OS 10.1.3",
		"PAN-OS 10.1.2",
		"PAN-OS 10.1.1",
		"PAN-OS 10.1.0",
		"PAN-OS 10.1",
		"PAN-OS 10.0.11",
		"PAN-OS 10.0.10",
		"PAN-OS 10.0.9",
		"PAN-OS 10.0.8-h8",
		"PAN-OS 10.0.8-h7",
		"PAN-OS 10.0.8-h6",
		"PAN-OS 10.0.8-h5",
		"PAN-OS 10.0.8-h4",
		"PAN-OS 10.0.8-h3",
		"PAN-OS 10.0.8-h2",
		"PAN-OS 10.0.8-h1",
		"PAN-OS 10.0.8",
		"PAN-OS 10.0.7",
		"PAN-OS 10.0.6",
		"PAN-OS 10.0.5",
		"PAN-OS 10.0.4",
		"PAN-OS 10.0.3",
		"PAN-OS 10.0.2",
		"PAN-OS 10.0.1",
		"PAN-OS 10.0.0",
		"PAN-OS 10.0",
		"PAN-OS 9.1.14-h3",
		"PAN-OS 9.1.14-h2",
		"PAN-OS 9.1.14-h1",
		"PAN-OS 9.1.14",
		"PAN-OS 9.1.13-h3",
		"PAN-OS 9.1.13-h2",
		"PAN-OS 9.1.13-h1",
		"PAN-OS 9.1.13",
		"PAN-OS 9.1.12-h3",
		"PAN-OS 9.1.12-h2",
		"PAN-OS 9.1.12-h1",
		"PAN-OS 9.1.12",
		"PAN-OS 9.1.11-h3",
		"PAN-OS 9.1.11-h2",
		"PAN-OS 9.1.11-h1",
		"PAN-OS 9.1.11",
		"PAN-OS 9.1.10",
		"PAN-OS 9.1.9",
		"PAN-OS 9.1.8",
		"PAN-OS 9.1.7",
		"PAN-OS 9.1.6",
		"PAN-OS 9.1.5",
		"PAN-OS 9.1.4",
		"PAN-OS 9.1.3-h1",
		"PAN-OS 9.1.3",
		"PAN-OS 9.1.2-h1",
		"PAN-OS 9.1.2",
		"PAN-OS 9.1.1",
		"PAN-OS 9.1.0-h3",
		"PAN-OS 9.1.0-h2",
		"PAN-OS 9.1.0-h1",
		"PAN-OS 9.1.0",
		"PAN-OS 9.1",
		"PAN-OS 9.0.16-h2",
		"PAN-OS 9.0.16-h1",
		"PAN-OS 9.0.16",
		"PAN-OS 9.0.15",
		"PAN-OS 9.0.14-h4",
		"PAN-OS 9.0.14-h3",
		"PAN-OS 9.0.14-h2",
		"PAN-OS 9.0.14-h1",
		"PAN-OS 9.0.14",
		"PAN-OS 9.0.13",
		"PAN-OS 9.0.12",
		"PAN-OS 9.0.11",
		"PAN-OS 9.0.10",
		"PAN-OS 9.0.9-h1",
		"PAN-OS 9.0.9",
		"PAN-OS 9.0.8",
		"PAN-OS 9.0.7",
		"PAN-OS 9.0.6",
		"PAN-OS 9.0.5",
		"PAN-OS 9.0.4",
		"PAN-OS 9.0.3-h3",
		"PAN-OS 9.0.3-h2",
		"PAN-OS 9.0.3-h1",
		"PAN-OS 9.0.3",
		"PAN-OS 9.0.2-h4",
		"PAN-OS 9.0.2-h3",
		"PAN-OS 9.0.2-h2",
		"PAN-OS 9.0.2-h1",
		"PAN-OS 9.0.2",
		"PAN-OS 9.0.1",
		"PAN-OS 9.0.0",
		"PAN-OS 9.0",
		"PAN-OS 8.1.23",
		"PAN-OS 8.1.22",
		"PAN-OS 8.1.21-h1",
		"PAN-OS 8.1.21",
		"PAN-OS 8.1.20-h1",
		"PAN-OS 8.1.20",
		"PAN-OS 8.1.19",
		"PAN-OS 8.1.18",
		"PAN-OS 8.1.17",
		"PAN-OS 8.1.16",
		"PAN-OS 8.1.15-h3",
		"PAN-OS 8.1.15-h2",
		"PAN-OS 8.1.15-h1",
		"PAN-OS 8.1.15",
		"PAN-OS 8.1.14-h2",
		"PAN-OS 8.1.14-h1",
		"PAN-OS 8.1.14",
		"PAN-OS 8.1.13",
		"PAN-OS 8.1.12",
		"PAN-OS 8.1.11",
		"PAN-OS 8.1.10",
		"PAN-OS 8.1.9-h4",
		"PAN-OS 8.1.9-h3",
		"PAN-OS 8.1.9-h2",
		"PAN-OS 8.1.9-h1",
		"PAN-OS 8.1.9",
		"PAN-OS 8.1.8-h5",
		"PAN-OS 8.1.8-h4",
		"PAN-OS 8.1.8-h3",
		"PAN-OS 8.1.8-h2",
		"PAN-OS 8.1.8-h1",
		"PAN-OS 8.1.8",
		"PAN-OS 8.1.7",
		"PAN-OS 8.1.6-h2",
		"PAN-OS 8.1.6-h1",
		"PAN-OS 8.1.6",
		"PAN-OS 8.1.5",
		"PAN-OS 8.1.4",
		"PAN-OS 8.1.3",
		"PAN-OS 8.1.2",
		"PAN-OS 8.1.1",
		"PAN-OS 8.1.0",
		"PAN-OS 8.1"
	],
	"fixed": [
		"All",
		"All",
		"All",
		"All",
		">= 10.2.2-h2",
		">= 10.1.6-h6",
		">= 10.0.11-h1",
		">= 9.1.14-h4",
		">= 9.0.16-h3",
		">= 8.1.23-h1",
		"All"
	],
	"date": "2022-08-10T16:00:00.000Z",
	"updated": "2022-08-19T16:22:00.000Z"
}
